#!/usr/bin/env bash

alias reload='source ~/.bashrc ; tmux source-file ~/.tmux.conf'
alias ka='killall'
alias cat='bat'
alias t='trash'
alias q='exit'
alias owa='code .'
alias se='sudoedit'
alias x='chmod +x'
alias h='htop'
alias winget='winget.exe'
alias pwsh='pwsh.exe'
alias wsl='wsl.exe'
alias dv='git diff'

fzf_dnf_install() {
  local package
  package=$1

  dnf_fzf() {
    local cache=$HOME/.cache/dnf_list.txt

    if test -f "$cache"; then
      package=$(\cat $cache | fzf_down)
    else
      dnf list | awk '{print $1}' | tail -n +4 >$cache
      package=$(\cat $cache | fzf_down)
    fi

    if [[ -n $package ]]; then
      sudo dnf install -y $package
    fi
  }

  if [[ -n $package ]]; then
    sudo dnf install -y $package
    ERROR=$?

    if [[ ERROR -eq 1 ]]; then
      dnf_fzf
    fi
  else
    dnf_fzf
  fi
}
alias ins='fzf_dnf_install'

dnf_fzf_remove() {
  local package
  package=$1

  dnf_fzf() {
    # cron job daily to update cache
    local cache=$HOME/.cache/dnf_list_installed.txt

    if test -f "$cache"; then
      package=$(\cat $cache | fzf_down)
    else
      dnf list --installed | awk '{print $1}' | tail -n +4 >$cache
      package=$(\cat $cache | fzf_down)
    fi

    if [[ -n $package ]]; then
      sudo dnf remove -y $package
    fi
  }

  if [[ -n $package ]]; then
    # TODO: don't use `rg` echo check issue for some case `rg` is not available by default -> use command system had default
    sudo dnf remove -y $package | rg "no match" &>/dev/null
    ERROR=$?

    if [[ ERROR -eq 0 ]]; then
      dnf_fzf
    else
      echo "removed $package"
    fi
  else
    dnf_fzf
  fi
}
alias uins='dnf_fzf_remove'

inss() {
  dnf search $1
  flatpak search $1
}

browser_daily() {
  xdg-open "https://facebook.com"
  xdg-open "https://www.youtube.com/feed/subscriptions"
  xdg-open "https://feeder.co/reader"
}

hi() {
  browser_daily
  sudo dnf update -y
  sudo dnf upgrade -y
  asdf update
  asdf plugin update --all
  neofetch
}

alias ..='cd .. ; l'
alias ...='cd .. ; cd .. ; l'
alias dow='cd ~/Downloads ; l'
alias doc='cd ~/Documents ; l'
alias tmp='cd /tmp'
alias changeDirToUsbFolder='cd /run/media/master/ ; ls'

alias ls='exa --long --all --icons'
alias l='ls'
alias sl='ls'
alias ll='ls'
alias la='exa --all --icons'
alias al='la'

make_dir() {
  if [ ! -n "$1" ]; then
    echo -n "ðŸ‘‰ Enter a directory name"
    read dirName
    mkdir -p $dirName
    cd $dirName
  elif [ -d $1 ]; then
    echo -e "ðŸ‘‰ $1 already exists"
    cd $1
  else
    mkdir -p $1
    cd $1
  fi
}
alias mk="make_dir"
